:root{
  --bg1:#04121f;   
  --bg2:#073457; 
  --bg3:#0f78b7;  

  --rose:#ff2e7a;
  --rose2:#ff6ea6;
  --gold:#ffd7a6;

  --glass: rgba(255,255,255,.10);
  --glass2: rgba(255,255,255,.06);

  --paper1:#fff7fb;
  --paper2:#fff1f7;
  --ink:#2b1530;

  --shadow: 0 30px 90px rgba(0,0,0,.45);
  --radius: 24px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:#fff;
  overflow-x:hidden;
  background:
    radial-gradient(1200px 900px at 18% 10%, rgba(122, 215, 255, .32), transparent 55%),
    radial-gradient(900px 700px at 82% 18%, rgba(183, 240, 255, .22), transparent 55%),
    radial-gradient(900px 700px at 60% 88%, rgba(70, 190, 255, .16), transparent 60%),
    radial-gradient(850px 650px at 52% 40%, rgba(255,110,166,.10), transparent 62%),
    linear-gradient(160deg, var(--bg1), var(--bg2) 45%, var(--bg3));
}

.bg{ position:fixed; inset:0; pointer-events:none; }
.stars{
  position:absolute; inset:0;
  background:
    radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.9), transparent 60%),
    radial-gradient(1px 1px at 22% 75%, rgba(255,255,255,.8), transparent 60%),
    radial-gradient(1px 1px at 38% 18%, rgba(255,255,255,.7), transparent 60%),
    radial-gradient(1px 1px at 48% 60%, rgba(255,255,255,.65), transparent 60%),
    radial-gradient(1.5px 1.5px at 64% 28%, rgba(255,255,255,.9), transparent 60%),
    radial-gradient(1px 1px at 76% 68%, rgba(255,255,255,.75), transparent 60%),
    radial-gradient(1px 1px at 86% 22%, rgba(255,255,255,.8), transparent 60%),
    radial-gradient(1.5px 1.5px at 92% 82%, rgba(255,255,255,.75), transparent 60%),
    radial-gradient(1px 1px at 14% 90%, rgba(255,255,255,.7), transparent 60%);
  opacity:.33;
  animation: twinkle 6s ease-in-out infinite alternate;
}
@keyframes twinkle{ from{opacity:.20;} to{opacity:.45;} }

.glow{
  position:absolute; inset:-30%;

  background:
    radial-gradient(420px 260px at 25% 20%, rgba(183, 240, 255, .22), transparent 60%),
    radial-gradient(520px 320px at 75% 28%, rgba(122, 215, 255, .18), transparent 62%),
    radial-gradient(520px 320px at 55% 85%, rgba(70, 190, 255, .14), transparent 65%),
    radial-gradient(520px 320px at 50% 55%, rgba(255,110,166,.08), transparent 66%);
  filter: blur(18px);
  animation: aurora 14s ease-in-out infinite alternate;
  opacity:.85;
}
.glow2{
  animation-duration: 18s;
  filter: blur(28px);
  opacity:.55;
  mix-blend-mode: screen;
}
@keyframes aurora{
  0%{ transform: translate(-2%, -1%) rotate(-2deg) scale(1.02); }
  100%{ transform: translate(2%, 1%) rotate(2deg) scale(1.06); }
}

.floaters{ position:absolute; inset:0; overflow:hidden; }
.floater{
  --x: 50;
  --s: 16;
  --d: 12;
  --delay: 0;
  position:absolute;
  left: calc(var(--x) * 1%);
  bottom:-20vh;

  width: calc(var(--s) * 1px);
  height: calc(var(--s) * 1px);
  transform: translateX(-50%) rotate(45deg);
  border-radius: 4px;

  background: linear-gradient(145deg, rgba(255,110,166,.95), rgba(255,46,122,.78));
  filter: drop-shadow(0 10px 18px rgba(255,46,122,.14));
  opacity:0;

  animation: floatUp calc(var(--d) * 1s) linear infinite;
  animation-delay: calc(var(--delay) * 1s);
}
.floater::before, .floater::after{
  content:"";
  position:absolute;
  width:100%; height:100%;
  background: inherit;
  border-radius: 50%;
}
.floater::before{ top:-50%; left:0; }
.floater::after{ left:-50%; top:0; }
@keyframes floatUp{
  0%{ transform:translateX(-50%) translateY(0) rotate(45deg); opacity:0; }
  10%{ opacity:.70; }
  70%{ opacity:.35; }
  100%{ transform:translateX(-50%) translateY(-120vh) rotate(45deg); opacity:0; }
}

.stage{
  min-height: 100vh;
  min-height: 100dvh;
  display:grid;
  place-items:center;
  padding: 26px 16px 56px;
  position:relative;
}

.backdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.25);
  opacity: 0;
  pointer-events: none;
  transition: opacity 260ms ease;
  z-index: 1;
}

#open-letter:checked ~ .backdrop{
  opacity: 1;
  pointer-events: auto;
}

#open-letter{
  position:absolute;
  inline-size:1px; block-size:1px;
  opacity:0;
  pointer-events:none;
}

.card{
  width:min(980px, 100%);
  border-radius: var(--radius);
  background: linear-gradient(180deg, var(--glass), var(--glass2));
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: var(--shadow);
  overflow:hidden;
  position:relative;
  transform: translateZ(0);
  z-index: 2;
}

.card::before{
  content:"";
  position:absolute;
  inset:-2px;

  background:
    radial-gradient(360px 160px at 22% 10%, rgba(183,240,255,.22), transparent 60%),
    radial-gradient(320px 190px at 78% 18%, rgba(122,215,255,.18), transparent 62%),
    radial-gradient(420px 220px at 55% 94%, rgba(255,110,166,.14), transparent 66%);
  filter: blur(16px);
  opacity:.8;
  pointer-events:none;
}

.top{
  padding: 18px 18px 0;
  position:relative;
}

.title{
  margin: 12px 0 6px;
  font-family: Fraunces, ui-serif, Georgia, serif;
  letter-spacing:.2px;
  line-height:1.05;
  font-size: clamp(28px, 4.2vw, 46px);
}
.name{
  background: linear-gradient(90deg, var(--gold), var(--rose2));
  -webkit-background-clip: text;
  background-clip:text;
  color: transparent;
  text-shadow: 0 10px 30px rgba(255,110,166,.12);
}
.subtitle{
  display:block;
  font-family: Inter, system-ui, sans-serif;
  font-size: clamp(13px, 2.2vw, 15px);
  opacity:.9;
  margin-top: 8px;
  letter-spacing:.15px;
}

.lead{
  margin: 0 0 14px;
  opacity:.92;
  max-width: 70ch;
  font-size: clamp(14px, 2.2vw, 16px);
  line-height: 1.55;
}

.scene{
  display:grid;
  grid-template-columns: 1.05fr .95fr;
  gap: 18px;
  padding: 16px 18px 20px;
  align-items: start;
  position:relative;
}

.panda-wrap{
  padding-top: 34px;
  display:grid;
  justify-items:center;
  gap: 10px;
}

.panda{
  width: min(480px, 100%);
  height:auto;
  filter: drop-shadow(0 26px 55px rgba(0,0,0,.45));
  animation: bob 3.6s ease-in-out infinite;
  transform-origin: 50% 80%;
}

.gumball{
  width: min(420px, 100%);
  height: auto;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 18px 55px rgba(0,0,0,.35);
  margin-top: 10px;
  display: block;
  user-select: none;
  -webkit-user-drag: none;
  pointer-events: none;
}

@keyframes bob{
  0%,100%{ transform: translateY(0) rotate(-.6deg); }
  50%{ transform: translateY(-6px) rotate(.6deg); }
}
.panda .heart{
  transform-origin: 0 0;
  animation: heartBeat 1.2s ease-in-out infinite;
  filter: drop-shadow(0 12px 18px rgba(255,46,122,.22));
}
@keyframes heartBeat{
  0%,100%{ transform: translate(260px,278px) scale(1); }
  50%{ transform: translate(260px,278px) scale(1.08); }
}
.panda .spark{ animation: sparkle 1.9s ease-in-out infinite; }
.panda .s2{ animation-delay: .4s; }
.panda .s3{ animation-delay: .8s; }
@keyframes sparkle{
  0%,100%{ opacity:.3; transform: translateY(0); }
  50%{ opacity:1; transform: translateY(-4px); }
}
.panda .blush{ animation: blush 2.6s ease-in-out infinite; }
@keyframes blush{
  0%,100%{ opacity:.22; }
  50%{ opacity:.38; }
}

.letter-zone{
  padding-top: 34px;
  display:grid;
  gap: 14px;
  justify-items:center;
  position:relative;
}

.cta{
  width:100%;
  cursor:pointer;
  user-select:none;
  display:grid;
  gap: 6px;
  padding: 14px 16px;
  border-radius: 16px;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 18px 45px rgba(0,0,0,.30);
  position:relative;
  overflow:hidden;
  text-align:left;
  z-index: 2;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

.cta-glow{
  position:absolute;
  inset:-40%;
  background:
    radial-gradient(260px 120px at 18% 40%, rgba(183,240,255,.22), transparent 60%),
    radial-gradient(280px 140px at 76% 20%, rgba(122,215,255,.18), transparent 62%),
    radial-gradient(260px 140px at 60% 80%, rgba(255,110,166,.10), transparent 66%);
  filter: blur(14px);
  opacity:.9;
  animation: aurora 10s ease-in-out infinite alternate;
  pointer-events: none;
}

.cta-text{ position:relative; font-weight: 600; }
.cta-mini{
  position:relative;
  font-size: 12px;
  opacity:.78;
}
.cta:hover{ transform: translateY(-2px); transition: transform .25s ease; }

.envelope{
  width:min(420px, 100%);
  aspect-ratio: 16/11;
  position:relative;
  filter: drop-shadow(0 22px 55px rgba(0,0,0,.45));
  pointer-events: none;
}
.env-back{
  position:absolute; inset:0;
  border-radius: 18px;
  background:
    radial-gradient(120% 120% at 30% 15%, rgba(255,215,166,.22), transparent 55%),
    radial-gradient(120% 120% at 80% 35%, rgba(255,46,122,.18), transparent 58%),
    linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
  border: 1px solid rgba(255,255,255,.18);
}
.env-front{
  position:absolute; inset:0;
  border-radius: 18px;
  overflow:hidden;
}
.env-front::before{
  content:"";
  position:absolute; inset:0;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.02));
  clip-path: polygon(0 40%, 50% 72%, 100% 40%, 100% 100%, 0 100%);
  border-top: 1px solid rgba(255,255,255,.10);
}
.env-front::after{
  content:"";
  position:absolute; inset:0;
  background: linear-gradient(135deg, rgba(255,110,166,.12), rgba(255,255,255,.02));
  clip-path: polygon(0 40%, 50% 72%, 0 100%);
  opacity:.9;
}

.env-flap{
  position:absolute;
  left:0; right:0;
  top:0;
  height: 58%;
  transform-origin: top center;
  transform: rotateX(0deg);
  transition: transform 900ms cubic-bezier(.2,.9,.2,1);
  border-top-left-radius: 18px;
  border-top-right-radius: 18px;
  overflow:hidden;
  z-index: 4;
}
.env-flap::before{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(120% 120% at 50% 10%, rgba(255,215,166,.30), transparent 55%),
    linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.02)),
    linear-gradient(45deg, rgba(255,110,166,.14), rgba(255,46,122,.10));
  clip-path: polygon(0 0, 100% 0, 50% 80%);
  border-bottom: 1px solid rgba(255,255,255,.12);
}

.seal{
  position:absolute;
  left: 50%;
  top: 52%;
  transform: translate(-50%,-50%);
  width: 90px;
  height: 90px;
  border-radius: 999px;
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.08) 55%, rgba(255,255,255,.02)),
    linear-gradient(135deg, rgba(255,215,166,.32), rgba(255,46,122,.18));
  border: 1px solid rgba(255,255,255,.22);
  box-shadow: 0 18px 40px rgba(0,0,0,.35);
  display:grid;
  place-items:center;
  gap: 6px;
  z-index: 5;
  transition: transform 900ms cubic-bezier(.2,.9,.2,1), opacity 500ms ease;
  padding: 10px;
  text-align:center;
}
.seal-heart{
  width: 18px;
  height: 18px;
  background: linear-gradient(145deg, var(--rose2), var(--rose));
  transform: rotate(45deg);
  border-radius: 4px;
  position:relative;
  filter: drop-shadow(0 8px 12px rgba(255,46,122,.20));
}
.seal-heart::before, .seal-heart::after{
  content:"";
  position:absolute;
  width:100%; height:100%;
  background: inherit;
  border-radius:50%;
}
.seal-heart::before{ top:-50%; left:0; }
.seal-heart::after{ left:-50%; top:0; }
.seal-text{
  font-size: 11.5px;
  opacity:.9;
  letter-spacing:.15px;
}

.letter{
  width:min(520px, 100%);
  border-radius: 18px;
  overflow:hidden;
  box-shadow: 0 24px 70px rgba(0,0,0,.38);
  transform: translateY(28px);
  opacity:0;
  pointer-events:none;
  transition: transform 980ms cubic-bezier(.2,.9,.2,1), opacity 520ms ease;
  position: relative;
  z-index: 5;
}

.paper{
  background:
    radial-gradient(240px 160px at 20% 8%, rgba(255,46,122,.08), transparent 62%),
    radial-gradient(260px 160px at 80% 10%, rgba(255,215,166,.10), transparent 66%),
    linear-gradient(180deg, var(--paper1), var(--paper2));
  color: var(--ink);
  border: 1px solid rgba(43,21,48,.10);
  padding: 16px 16px 14px;
  position:relative;
  max-height: 72vh;
  max-height: 72dvh;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

.paper::before{
  content:"";
  position:absolute; inset:0;
  background:
    repeating-linear-gradient(
      180deg,
      rgba(43,21,48,.04) 0px,
      rgba(43,21,48,.04) 1px,
      transparent 1px,
      transparent 18px
    );
  opacity:.55;
  pointer-events:none;
}
.paper > *{ position:relative; }

.close-letter{
  position:absolute;
  top: 10px;
  right: 10px;
  width: 46px;
  height: 46px;
  border-radius: 12px;
  border: 1px solid rgba(43,21,48,.14);
  background: rgba(255,255,255,.70);
  color: rgba(43,21,48,.90);
  cursor:pointer;
  font-size: 22px;
  line-height: 1;
  display:grid;
  place-items:center;
  box-shadow: 0 16px 28px rgba(0,0,0,.14);
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

.close-letter:hover{ transform: translateY(-1px); }
.close-letter:active{ transform: translateY(0); }

.paper h2{
  margin: 4px 0 10px;
  font-family: Fraunces, ui-serif, Georgia, serif;
  font-size: 22px;
  letter-spacing:.2px;
}
.h2-sub{
  display:block;
  margin-top: 6px;
  font-family: Inter, system-ui, sans-serif;
  font-size: 13px;
  opacity:.78;
}

.type{ margin: 0 0 10px; }
.typewriter{
  display:inline-block;
  white-space:nowrap;
  overflow:hidden;
  border-right: 2px solid rgba(195,25,83,.7);
  width: 0;
  animation: typing 4.1s steps(60,end) 1.0s forwards, caret .75s steps(1,end) infinite;
  max-width:100%;
}
@keyframes typing{ from{width:0;} to{width:min(62ch, 100%);} }
@keyframes caret{
  0%,49%{ border-right-color: rgba(195,25,83,.75); }
  50%,100%{ border-right-color: transparent; }
}

.msg{
  margin: 0 0 12px;
  font-size: 14.5px;
  line-height: 1.58;
}

.timeline{
  display:grid;
  gap: 10px;
  margin: 10px 0 12px;
  padding: 10px 12px;
  border-radius: 16px;
  background: rgba(255,46,122,.08);
  border: 1px solid rgba(255,46,122,.16);
}
.milestone{
  display:flex;
  gap: 10px;
  align-items:flex-start;
}
.milestone .dot{
  width: 10px; height: 10px;
  border-radius:50%;
  margin-top: 5px;
  background: radial-gradient(circle at 30% 30%, #fff, var(--rose));
  box-shadow: 0 0 0 6px rgba(255,46,122,.10);
}
.m-title{ font-weight: 700; font-size: 13px; }
.m-sub{ font-size: 13px; opacity:.86; margin-top: 2px; line-height:1.35; }

.promise{
  margin: 0 0 12px;
  padding: 10px 12px;
  border-radius: 16px;
  background: rgba(255,215,166,.16);
  border: 1px solid rgba(255,215,166,.24);
  font-size: 13.5px;
  line-height: 1.5;
}

.sign{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap: 12px;
  padding-top: 10px;
  border-top: 1px dashed rgba(43,21,48,.22);
}
.sig{
  display:block;
  font-family: Fraunces, ui-serif, Georgia, serif;
  font-size: 18px;
  letter-spacing:.2px;
  background: linear-gradient(90deg, #2b1530, #c31953);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
}
.sig-sub{
  display:block;
  margin-top: 3px;
  font-size: 12px;
  opacity:.78;
}

.days{
  text-align:right;
  padding: 10px 12px;
  border-radius: 16px;
  background: rgba(255,255,255,.55);
  border: 1px solid rgba(43,21,48,.10);
}
.days-num{
  font-family: Fraunces, ui-serif, Georgia, serif;
  font-size: 26px;
  line-height:1;
}
.days-sub{
  font-size: 11.5px;
  opacity:.72;
  margin-top: 6px;
}
.days-today{
  font-size: 11.5px;
  opacity:.85;
  margin-top: 6px;
}
.days-ymd{
  font-size: 11.5px;
  opacity: .88;
  margin-top: 6px;
}

#open-letter:checked ~ .card .env-flap{
  transform: rotateX(180deg);
}
#open-letter:checked ~ .card .seal{
  transform: translate(-50%,-50%) scale(.90) rotate(-10deg);
  opacity:.55;
}
#open-letter:checked ~ .card .letter{
  transform: translateY(0);
  opacity: 1;
  pointer-events:auto;
}

#open-letter:checked ~ .card .cta{
  z-index: 1;
}

.card:hover{
  transform: translateY(-2px);
  transition: transform .35s ease;
}

.paper{
  max-height: 72vh;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

@media (max-width: 900px){
  .scene{ grid-template-columns: 1fr; }
  .panda-wrap, .letter-zone{ padding-top: 0; }
}

@media (prefers-reduced-motion: reduce){
  *, *::before, *::after{
    animation: none !important;
    transition: none !important;
    scroll-behavior: auto !important;
  }
  .floater{ opacity:.12; }
  .glow, .glow2{ opacity:.35; }
  .typewriter{ border-right: none; width:auto; }
}

.cta:focus-visible,
.close-letter:focus-visible{
  outline: 3px solid rgba(183,240,255,.95);
  outline-offset: 3px;
}